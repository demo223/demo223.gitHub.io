<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>周岐的个人博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="logo.jpg">
    <meta name="description" content="个人技术博客">
    
    <link rel="preload" href="/assets/css/0.styles.8c53e149.css" as="style"><link rel="preload" href="/assets/js/app.a19eb3cb.js" as="script"><link rel="preload" href="/assets/js/2.34fff606.js" as="script"><link rel="preload" href="/assets/js/1.16393a26.js" as="script"><link rel="preload" href="/assets/js/71.0051199b.js" as="script"><link rel="prefetch" href="/assets/js/10.717bd423.js"><link rel="prefetch" href="/assets/js/100.c5cd47b0.js"><link rel="prefetch" href="/assets/js/101.7151b423.js"><link rel="prefetch" href="/assets/js/102.6b36385a.js"><link rel="prefetch" href="/assets/js/103.d3861779.js"><link rel="prefetch" href="/assets/js/104.9578b311.js"><link rel="prefetch" href="/assets/js/105.aae477dc.js"><link rel="prefetch" href="/assets/js/106.1d5215a7.js"><link rel="prefetch" href="/assets/js/107.3c330c2f.js"><link rel="prefetch" href="/assets/js/108.cefc2802.js"><link rel="prefetch" href="/assets/js/109.541aa22e.js"><link rel="prefetch" href="/assets/js/11.e0bfb9a4.js"><link rel="prefetch" href="/assets/js/110.60e0b929.js"><link rel="prefetch" href="/assets/js/111.45058523.js"><link rel="prefetch" href="/assets/js/112.d10d50d0.js"><link rel="prefetch" href="/assets/js/113.4a3deb35.js"><link rel="prefetch" href="/assets/js/114.b917d1a1.js"><link rel="prefetch" href="/assets/js/115.50e3fa0f.js"><link rel="prefetch" href="/assets/js/116.78f04bf7.js"><link rel="prefetch" href="/assets/js/117.b5372645.js"><link rel="prefetch" href="/assets/js/118.f990eb5b.js"><link rel="prefetch" href="/assets/js/119.f178eabd.js"><link rel="prefetch" href="/assets/js/12.bdf46c02.js"><link rel="prefetch" href="/assets/js/120.d98a3aa8.js"><link rel="prefetch" href="/assets/js/121.abcdf60f.js"><link rel="prefetch" href="/assets/js/122.ed3550a9.js"><link rel="prefetch" href="/assets/js/123.8ef421f8.js"><link rel="prefetch" href="/assets/js/124.1adba2c7.js"><link rel="prefetch" href="/assets/js/125.6706c196.js"><link rel="prefetch" href="/assets/js/126.1e50c7b4.js"><link rel="prefetch" href="/assets/js/127.be9df6e0.js"><link rel="prefetch" href="/assets/js/128.9e68fe60.js"><link rel="prefetch" href="/assets/js/129.f9313e6a.js"><link rel="prefetch" href="/assets/js/13.05b00624.js"><link rel="prefetch" href="/assets/js/130.87d4d918.js"><link rel="prefetch" href="/assets/js/131.b7ab0bc3.js"><link rel="prefetch" href="/assets/js/132.4bf1103a.js"><link rel="prefetch" href="/assets/js/133.2bda9aa2.js"><link rel="prefetch" href="/assets/js/134.e6631028.js"><link rel="prefetch" href="/assets/js/135.5b78aed3.js"><link rel="prefetch" href="/assets/js/136.377fd687.js"><link rel="prefetch" href="/assets/js/137.623e1a9d.js"><link rel="prefetch" href="/assets/js/138.c2e1c9a1.js"><link rel="prefetch" href="/assets/js/139.6263f657.js"><link rel="prefetch" href="/assets/js/14.092a5584.js"><link rel="prefetch" href="/assets/js/140.a54c064d.js"><link rel="prefetch" href="/assets/js/141.0de2ed45.js"><link rel="prefetch" href="/assets/js/142.61ea0663.js"><link rel="prefetch" href="/assets/js/143.24d35022.js"><link rel="prefetch" href="/assets/js/144.196d7653.js"><link rel="prefetch" href="/assets/js/145.223f0fcf.js"><link rel="prefetch" href="/assets/js/146.a09f8d1b.js"><link rel="prefetch" href="/assets/js/147.62d69c7c.js"><link rel="prefetch" href="/assets/js/148.d46a05d0.js"><link rel="prefetch" href="/assets/js/149.467faf3d.js"><link rel="prefetch" href="/assets/js/15.758ee11b.js"><link rel="prefetch" href="/assets/js/150.0443932e.js"><link rel="prefetch" href="/assets/js/151.0879c074.js"><link rel="prefetch" href="/assets/js/152.4d08f8a9.js"><link rel="prefetch" href="/assets/js/153.ce46c4fa.js"><link rel="prefetch" href="/assets/js/154.fd65dd72.js"><link rel="prefetch" href="/assets/js/155.b975728f.js"><link rel="prefetch" href="/assets/js/156.61194924.js"><link rel="prefetch" href="/assets/js/157.97e4f54e.js"><link rel="prefetch" href="/assets/js/158.5290a2f0.js"><link rel="prefetch" href="/assets/js/159.3613e64b.js"><link rel="prefetch" href="/assets/js/16.2569be64.js"><link rel="prefetch" href="/assets/js/160.87d90e6b.js"><link rel="prefetch" href="/assets/js/161.a2a67f25.js"><link rel="prefetch" href="/assets/js/162.b51ccce1.js"><link rel="prefetch" href="/assets/js/163.85d33d23.js"><link rel="prefetch" href="/assets/js/164.5504b77f.js"><link rel="prefetch" href="/assets/js/165.be283131.js"><link rel="prefetch" href="/assets/js/166.8d0352c5.js"><link rel="prefetch" href="/assets/js/167.89c23a71.js"><link rel="prefetch" href="/assets/js/168.aa736b2c.js"><link rel="prefetch" href="/assets/js/169.296ccc1d.js"><link rel="prefetch" href="/assets/js/17.5b873df7.js"><link rel="prefetch" href="/assets/js/170.c706da49.js"><link rel="prefetch" href="/assets/js/171.6f79aeb1.js"><link rel="prefetch" href="/assets/js/172.ddcae302.js"><link rel="prefetch" href="/assets/js/173.f308eb43.js"><link rel="prefetch" href="/assets/js/174.b5ece966.js"><link rel="prefetch" href="/assets/js/175.538e3125.js"><link rel="prefetch" href="/assets/js/176.d54091dd.js"><link rel="prefetch" href="/assets/js/177.2ee0aa3d.js"><link rel="prefetch" href="/assets/js/178.667b3c59.js"><link rel="prefetch" href="/assets/js/179.07595c3e.js"><link rel="prefetch" href="/assets/js/18.4c170722.js"><link rel="prefetch" href="/assets/js/180.300e0b70.js"><link rel="prefetch" href="/assets/js/181.89473dcd.js"><link rel="prefetch" href="/assets/js/182.ea6036d1.js"><link rel="prefetch" href="/assets/js/183.647f8d55.js"><link rel="prefetch" href="/assets/js/184.2e79dd55.js"><link rel="prefetch" href="/assets/js/185.bf4d6269.js"><link rel="prefetch" href="/assets/js/186.7a7ceaa7.js"><link rel="prefetch" href="/assets/js/187.09bb0f21.js"><link rel="prefetch" href="/assets/js/188.3604ce73.js"><link rel="prefetch" href="/assets/js/189.49b47b33.js"><link rel="prefetch" href="/assets/js/19.a45744ea.js"><link rel="prefetch" href="/assets/js/190.88e59ff4.js"><link rel="prefetch" href="/assets/js/191.a4b3e5c7.js"><link rel="prefetch" href="/assets/js/192.7527e6ed.js"><link rel="prefetch" href="/assets/js/193.c44a652d.js"><link rel="prefetch" href="/assets/js/194.6aaca2ce.js"><link rel="prefetch" href="/assets/js/195.64837df2.js"><link rel="prefetch" href="/assets/js/196.e1bd3d69.js"><link rel="prefetch" href="/assets/js/197.2b01de81.js"><link rel="prefetch" href="/assets/js/198.d1496fd2.js"><link rel="prefetch" href="/assets/js/199.27ab1442.js"><link rel="prefetch" href="/assets/js/20.4cb27e25.js"><link rel="prefetch" href="/assets/js/200.996d49f4.js"><link rel="prefetch" href="/assets/js/201.b71a4422.js"><link rel="prefetch" href="/assets/js/202.0ea49eaa.js"><link rel="prefetch" href="/assets/js/203.8ebb1f77.js"><link rel="prefetch" href="/assets/js/204.c8d10533.js"><link rel="prefetch" href="/assets/js/205.0b8c4d0d.js"><link rel="prefetch" href="/assets/js/206.cce9bcce.js"><link rel="prefetch" href="/assets/js/207.8130e9ba.js"><link rel="prefetch" href="/assets/js/208.871753be.js"><link rel="prefetch" href="/assets/js/209.757eda19.js"><link rel="prefetch" href="/assets/js/21.445690e6.js"><link rel="prefetch" href="/assets/js/210.983cae1d.js"><link rel="prefetch" href="/assets/js/211.8e4ddaf8.js"><link rel="prefetch" href="/assets/js/212.6412fc61.js"><link rel="prefetch" href="/assets/js/213.656a6a73.js"><link rel="prefetch" href="/assets/js/214.befcd199.js"><link rel="prefetch" href="/assets/js/215.2c292e81.js"><link rel="prefetch" href="/assets/js/216.78cc7e8b.js"><link rel="prefetch" href="/assets/js/217.4fa8b1da.js"><link rel="prefetch" href="/assets/js/218.4c8cce7c.js"><link rel="prefetch" href="/assets/js/219.d041d013.js"><link rel="prefetch" href="/assets/js/22.bc7c4cdb.js"><link rel="prefetch" href="/assets/js/220.10a9ed88.js"><link rel="prefetch" href="/assets/js/221.bc25f391.js"><link rel="prefetch" href="/assets/js/222.dfdd15b7.js"><link rel="prefetch" href="/assets/js/223.1afa90d8.js"><link rel="prefetch" href="/assets/js/224.69bb037f.js"><link rel="prefetch" href="/assets/js/225.94590311.js"><link rel="prefetch" href="/assets/js/226.d1818961.js"><link rel="prefetch" href="/assets/js/227.2a969459.js"><link rel="prefetch" href="/assets/js/228.e3f5706b.js"><link rel="prefetch" href="/assets/js/229.0e6df830.js"><link rel="prefetch" href="/assets/js/23.b7994ecf.js"><link rel="prefetch" href="/assets/js/230.6bc93aa6.js"><link rel="prefetch" href="/assets/js/231.9b7cc0ec.js"><link rel="prefetch" href="/assets/js/232.80b7488d.js"><link rel="prefetch" href="/assets/js/233.302790de.js"><link rel="prefetch" href="/assets/js/234.68b70723.js"><link rel="prefetch" href="/assets/js/235.1b3c3110.js"><link rel="prefetch" href="/assets/js/236.e536b7bb.js"><link rel="prefetch" href="/assets/js/237.cca351a3.js"><link rel="prefetch" href="/assets/js/238.f4d0edb0.js"><link rel="prefetch" href="/assets/js/239.4f57e73d.js"><link rel="prefetch" href="/assets/js/24.26e26a07.js"><link rel="prefetch" href="/assets/js/240.1e76f670.js"><link rel="prefetch" href="/assets/js/241.8795d427.js"><link rel="prefetch" href="/assets/js/242.c72205cb.js"><link rel="prefetch" href="/assets/js/243.d7105431.js"><link rel="prefetch" href="/assets/js/244.361b2ea5.js"><link rel="prefetch" href="/assets/js/245.055fa0a3.js"><link rel="prefetch" href="/assets/js/246.0dee7b05.js"><link rel="prefetch" href="/assets/js/247.c13fc7d7.js"><link rel="prefetch" href="/assets/js/248.4e481dba.js"><link rel="prefetch" href="/assets/js/25.626c2c33.js"><link rel="prefetch" href="/assets/js/26.c4aa6beb.js"><link rel="prefetch" href="/assets/js/27.b1a828b7.js"><link rel="prefetch" href="/assets/js/28.f9133ade.js"><link rel="prefetch" href="/assets/js/29.54e09df1.js"><link rel="prefetch" href="/assets/js/3.4db2e19a.js"><link rel="prefetch" href="/assets/js/30.d2654359.js"><link rel="prefetch" href="/assets/js/31.c57cf20e.js"><link rel="prefetch" href="/assets/js/32.ed5593a9.js"><link rel="prefetch" href="/assets/js/33.05f050d1.js"><link rel="prefetch" href="/assets/js/34.6d7f5b2f.js"><link rel="prefetch" href="/assets/js/35.67cc577c.js"><link rel="prefetch" href="/assets/js/36.0bbc204a.js"><link rel="prefetch" href="/assets/js/37.8ac35368.js"><link rel="prefetch" href="/assets/js/38.50bd8dba.js"><link rel="prefetch" href="/assets/js/39.38b783ce.js"><link rel="prefetch" href="/assets/js/4.66c035fd.js"><link rel="prefetch" href="/assets/js/40.cd3ee2ff.js"><link rel="prefetch" href="/assets/js/41.f4bec9a4.js"><link rel="prefetch" href="/assets/js/42.27fa7fec.js"><link rel="prefetch" href="/assets/js/43.2af4a015.js"><link rel="prefetch" href="/assets/js/44.8e48aaf4.js"><link rel="prefetch" href="/assets/js/45.d41c0319.js"><link rel="prefetch" href="/assets/js/46.de5cb880.js"><link rel="prefetch" href="/assets/js/47.cc7c8048.js"><link rel="prefetch" href="/assets/js/48.22c69558.js"><link rel="prefetch" href="/assets/js/49.cdd62276.js"><link rel="prefetch" href="/assets/js/5.632744e8.js"><link rel="prefetch" href="/assets/js/50.a7eebe42.js"><link rel="prefetch" href="/assets/js/51.a447aa90.js"><link rel="prefetch" href="/assets/js/52.c0f076a5.js"><link rel="prefetch" href="/assets/js/53.3564c5b0.js"><link rel="prefetch" href="/assets/js/54.c5c6e6be.js"><link rel="prefetch" href="/assets/js/55.0fcb916b.js"><link rel="prefetch" href="/assets/js/56.2812bd7d.js"><link rel="prefetch" href="/assets/js/57.4f95d22a.js"><link rel="prefetch" href="/assets/js/58.d9baba05.js"><link rel="prefetch" href="/assets/js/59.371bd0d7.js"><link rel="prefetch" href="/assets/js/6.85f26be6.js"><link rel="prefetch" href="/assets/js/60.a715876a.js"><link rel="prefetch" href="/assets/js/61.6b1a782b.js"><link rel="prefetch" href="/assets/js/62.11484b5e.js"><link rel="prefetch" href="/assets/js/63.7b92573e.js"><link rel="prefetch" href="/assets/js/64.98aee69e.js"><link rel="prefetch" href="/assets/js/65.aa40eacd.js"><link rel="prefetch" href="/assets/js/66.67703170.js"><link rel="prefetch" href="/assets/js/67.392b86af.js"><link rel="prefetch" href="/assets/js/68.9610b8e9.js"><link rel="prefetch" href="/assets/js/69.6277fc7a.js"><link rel="prefetch" href="/assets/js/7.b775b056.js"><link rel="prefetch" href="/assets/js/70.b47adb04.js"><link rel="prefetch" href="/assets/js/72.fa131834.js"><link rel="prefetch" href="/assets/js/73.fd8d275f.js"><link rel="prefetch" href="/assets/js/74.82095aed.js"><link rel="prefetch" href="/assets/js/75.41fad4ea.js"><link rel="prefetch" href="/assets/js/76.36bb1714.js"><link rel="prefetch" href="/assets/js/77.83c409c1.js"><link rel="prefetch" href="/assets/js/78.ca197ebf.js"><link rel="prefetch" href="/assets/js/79.9f0de524.js"><link rel="prefetch" href="/assets/js/80.7dd0f8a1.js"><link rel="prefetch" href="/assets/js/81.a5d44424.js"><link rel="prefetch" href="/assets/js/82.03d59f96.js"><link rel="prefetch" href="/assets/js/83.43da9399.js"><link rel="prefetch" href="/assets/js/84.e9ab171d.js"><link rel="prefetch" href="/assets/js/85.523fe07f.js"><link rel="prefetch" href="/assets/js/86.90aac9c6.js"><link rel="prefetch" href="/assets/js/87.1af6082d.js"><link rel="prefetch" href="/assets/js/88.3d7d10f0.js"><link rel="prefetch" href="/assets/js/89.69f4fbaf.js"><link rel="prefetch" href="/assets/js/90.30407e67.js"><link rel="prefetch" href="/assets/js/91.94355f67.js"><link rel="prefetch" href="/assets/js/92.8247a2fb.js"><link rel="prefetch" href="/assets/js/93.245ee436.js"><link rel="prefetch" href="/assets/js/94.a212b15e.js"><link rel="prefetch" href="/assets/js/95.dec85448.js"><link rel="prefetch" href="/assets/js/96.77ebb7ae.js"><link rel="prefetch" href="/assets/js/97.0a615ee3.js"><link rel="prefetch" href="/assets/js/98.9d539c75.js"><link rel="prefetch" href="/assets/js/99.270c2389.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.b7a3ab4f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8c53e149.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">周岐的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java SE/guide.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/项目总结/Mybatis使用/Mybatis分页实现.html" class="nav-link">
  项目总结
</a></div><div class="nav-item"><a href="/Java面试题/Java基础面试题/==和equals的区别.html" class="nav-link">
  Java面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="了解更多" class="dropdown-title"><span class="title">了解更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="了解更多" class="mobile-dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/demo223" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/zhouqi-5zipq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java SE/guide.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/项目总结/Mybatis使用/Mybatis分页实现.html" class="nav-link">
  项目总结
</a></div><div class="nav-item"><a href="/Java面试题/Java基础面试题/==和equals的区别.html" class="nav-link">
  Java面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="了解更多" class="dropdown-title"><span class="title">了解更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="了解更多" class="mobile-dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/demo223" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/zhouqi-5zipq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/java SE/guide" class="sidebar-heading clickable"><span>java SE</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mybatis-Plus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常用工具类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java面试题</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/Java基础面试题/==和equals的区别" class="sidebar-heading clickable"><span>Java基础面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/多线程面试题/多线程面试题" class="sidebar-heading clickable"><span>多线程面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/集合面试题/Java集合相关面试题" class="sidebar-heading clickable"><span>集合面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/Mybatis面试题/Mybatis面试题" class="sidebar-heading clickable"><span>Mybatis面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/SpringBoot面试题/SpringBoot面试题" class="sidebar-heading clickable"><span>SpringBoot面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/MySQL面试题/MySQL面试题" class="sidebar-heading clickable"><span>MySQL面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/Redis面试题/Redis面试题" class="sidebar-heading clickable"><span>Redis面试题</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Java面试题/微服务面试题/微服务面试题" class="sidebar-heading clickable open"><span>微服务面试题</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Java面试题/微服务面试题/微服务面试题.html" class="sidebar-link">微服务面试题</a></li><li><a href="/Java面试题/微服务面试题/微服务问题.html" class="sidebar-link">微服务问题</a></li><li><a href="/Java面试题/微服务面试题/MQ系列面试题.html" class="sidebar-link">MQ系列面试题</a></li><li><a href="/Java面试题/微服务面试题/微服务面试题补充.html" class="active sidebar-link">微服务面试题补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java面试题/微服务面试题/微服务面试题补充.html#_1-springboot" class="sidebar-link">1 Springboot</a></li><li class="sidebar-sub-header"><a href="/Java面试题/微服务面试题/微服务面试题补充.html#_2-springcloud" class="sidebar-link">2 SpringCloud</a></li><li class="sidebar-sub-header"><a href="/Java面试题/微服务面试题/微服务面试题补充.html#_3-分布式事务篇" class="sidebar-link">3 分布式事务篇</a></li><li class="sidebar-sub-header"><a href="/Java面试题/微服务面试题/微服务面试题补充.html#_4-面试现场" class="sidebar-link">4 面试现场</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/SpringBoot文档/01-Spring-IOC" class="sidebar-heading clickable"><span>SpringBoot文档</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/微服务文档/SpringCloud介绍" class="sidebar-heading clickable"><span>微服务文档</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>微服务面试题</p> <h2 id="_1-springboot"><a href="#_1-springboot" class="header-anchor">#</a> 1 Springboot</h2> <h3 id="_1-1-讲一讲"><a href="#_1-1-讲一讲" class="header-anchor">#</a> 1.1 讲一讲</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p>嗯，好的，它是这样的。</p> <p>在Spring Boot项目中的引导类上有一个注解<code>@SpringBootApplication</code>，这个注解是对三个注解进行了封装，分别是：</p> <ul><li><p><code>@SpringBootConfiguration</code></p></li> <li><p><code>@EnableAutoConfiguration</code></p></li> <li><p><code>@ComponentScan</code></p></li></ul> <p>其中<code>@EnableAutoConfiguration</code>是实现自动化配置的核心注解。</p> <p>该注解通过<code>@Import</code>注解导入对应的配置选择器。关键的是内部就是读取了该项目和该项目引用的Jar包的的classpath路径下<strong>META-INF/spring.factories</strong>文件中的所配置的类的全类名。</p> <p>在这些配置类中所定义的Bean会根据条件注解所<strong>指定的条件来决定</strong>是否需要将其导入到Spring容器中。</p> <p>一般条件判断会有像<code>@ConditionalOnClass</code>这样的注解，判断是否有对应的class文件，如果有则加载该类，把这个配置类的所有的Bean放入spring容器中使用。</p> <h3 id="_1-2-讲一讲springboot启动流程"><a href="#_1-2-讲一讲springboot启动流程" class="header-anchor">#</a> 1.2 讲一讲SpringBoot启动流程</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>springboot项目在启动的时候, 首先会执行启动引导类里面的</p> <p><code>SpringApplication.run(AdminApplication.class, args)</code>方法</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220821224248791.png" alt="image-20220821224248791"></p> <p>这个run方法主要做的事情可以分为三个部分 :</p> <p>第一部分进行SpringApplication的初始化模块，配置一些基本的环境变量、资源、构造器、监听器</p> <p>第二部分实现了应用具体的启动方案，包括启动流程的监听模块、加载配置环境模块、及核心的创建上下文环境模块</p> <p>第三部分是自动化配置模块，该模块作为springboot自动配置核心</p> <h3 id="_1-3-你们常用的springboot起步依赖有哪些"><a href="#_1-3-你们常用的springboot起步依赖有哪些" class="header-anchor">#</a> 1.3 你们常用的SpringBoot起步依赖有哪些</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220821224354029.png" alt="image-20220821224354029"></p> <h3 id="_1-4-springboot支持的配置文件有哪些-加载顺序是什么样的"><a href="#_1-4-springboot支持的配置文件有哪些-加载顺序是什么样的" class="header-anchor">#</a> 1.4 springBoot支持的配置文件有哪些 ? 加载顺序是什么样的</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>springboot项目支持很多的配置文件，在源码可以看到</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220907160806687.png" alt="image-20220907160806687"></p> <p>它会按照这个不同类型的文件从上到下的顺序进行加载，也就说，会先加载application.yml然后加载application.properties文件。如果有相同的配置，先加载的会被后加载的文件覆盖</p> <p>假如在启动项目的时候给了启动参数，则最后生效，会覆盖前面所有相同的配置</p> <p><code>java -jar --server.port=8089 xx.jar</code></p> <h3 id="_1-5-运行一个springboot项目有哪些方式"><a href="#_1-5-运行一个springboot项目有哪些方式" class="header-anchor">#</a> 1.5 运行一个SpringBoot项目有哪些方式</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <ol><li><p>直接使用jar -jar 运行</p></li> <li><p>开发过程中运行main方法</p></li> <li><p>可以配置插件 , 将springboot项目打war包, 部署到Tomcat中运行</p></li> <li><p>直接用maven插件运行 maven spring-boot：run</p></li></ol> <h3 id="_1-6-spring-boot的核心注解是哪个-他由哪几个注解组成的"><a href="#_1-6-spring-boot的核心注解是哪个-他由哪几个注解组成的" class="header-anchor">#</a> 1.6 Spring Boot的核心注解是哪个？他由哪几个注解组成的？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>Spring Boot的核心注解是@SpringBootApplication , 他由几个注解组成 :</p> <ul><li>@SpringBootConfiguration： 组合了- @Configuration注解，实现配置文件的功能；</li> <li>@EnableAutoConfiguration：打开自动配置的功能，也可以关闭某个自动配置的选项</li> <li>@ComponentScan：Spring组件扫描</li></ul> <h3 id="_1-7-你们项目中使用的springboot是哪个版本"><a href="#_1-7-你们项目中使用的springboot是哪个版本" class="header-anchor">#</a> 1.7 你们项目中使用的SpringBoot是哪个版本 ?</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆</p></blockquote> <ul><li>SpringBoot : 2.3.9.RELEASE</li> <li>SpringCloud : Hoxton.SR10</li> <li>SpringCloudAlibaba : 2.2.5.RELEASE</li></ul> <h3 id="_1-8-spring-boot如何定义多套不同环境配置"><a href="#_1-8-spring-boot如何定义多套不同环境配置" class="header-anchor">#</a> 1.8 Spring Boot如何定义多套不同环境配置？</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆</p></blockquote> <p>提供多套配置文件，如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>applcation.properties
application-dev.properties
application-test.properties
application-prod.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>springboot当中，<code>application</code>是我们的主配置文件，至于是yml结尾的文件还是<code>properties</code>结尾的文件，这两种都可以的，没有实质区别，都是更改springboot全局默认值。唯一的区别就是语法区别。</p></blockquote> <p>然后在<code>applcation.properties</code>文件中指定当前的环境<code>spring.profiles.active=test</code>,这时候读取的就是<code>application-test.properties</code>文件。</p> <h2 id="_2-springcloud"><a href="#_2-springcloud" class="header-anchor">#</a> 2 SpringCloud</h2> <h3 id="_2-1-什么是微服务-微服务的优缺点是什么"><a href="#_2-1-什么是微服务-微服务的优缺点是什么" class="header-anchor">#</a> 2.1 什么是微服务?微服务的优缺点是什么?</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p><strong>微服务</strong></p> <p>将单体服务拆分成一组小型服务。拆分完成之后，每个小型服务都运行在独立的进程中。服务与服务之间采用轻量级的通信机制来进行沟通（Spring Cloud 中是基于Http请求）</p> <p>每一个服务都按照具体的业务进行构建，如电商系统中，订单服务，会员服务，支付服务等。这些拆分出来的服务都是独立的应用服务，可以独立的部署到上产环境中。相互之间不会受影响。所以一个微服务项目就可以根据业务场景进行开发。这在单体类项目中是无法实现的。</p> <p><strong>优点</strong>：松耦合，聚焦单一业务功能，无关开发语言，团队规模降低。在开发中，不需要了解多有业务，只专注于当前功能，便利集中，功能小而精。微服务一个功能受损，对其他功能影响并不是太大，可以快速定位问题。微服务只专注于当前业务逻辑代码，不会和 html、css 或其他界面进行混合。可以灵活搭配技术，独立性比较好。</p> <p><strong>缺点</strong>：随着服务数量增加，管理复杂，部署复杂，服务器需要增多，服务通信和调用压力增大，运维工程师压力增大，人力资源增多，系统依赖增强，数据一致性，性能监控。</p> <h3 id="_2-2-spring-cloud-5大组件有哪些"><a href="#_2-2-spring-cloud-5大组件有哪些" class="header-anchor">#</a> 2.2 Spring Cloud 5大组件有哪些？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p>早期我们一般认为的Spring Cloud五大组件是</p> <ul><li>Eureka   : 注册中心</li> <li>Ribbon  : 负载均衡</li> <li>Feign     : 远程调用</li> <li>Hystrix :  服务熔断</li> <li>Zuul/Gateway  : 网关</li></ul> <p>随着SpringCloudAlibba在国内兴起 , 我们项目中使用了一些阿里巴巴的组件</p> <ul><li><p>注册中心/配置中心 Nacos</p></li> <li><p>负载均衡 Ribbon</p></li> <li><p>服务调用 Feign</p></li> <li><p>服务保护 sentinel</p></li> <li><p>服务网关 Gateway</p></li></ul> <hr> <p>Spring Cloud 通常包括以下五大组件：</p> <ol><li><code>Eureka</code>：Eureka 是服务发现组件，用于服务注册和发现。它允许应用程序在集群中注册服务，同时也允许其他应用程序查找可用的服务实例。</li> <li><code>Ribbon</code>：Ribbon 是客户端负载均衡组件，它可以通过在多个服务实例之间分配流量来提高应用程序的可靠性和可扩展性。</li> <li><code>Feign</code>：Feign 是一个声明式的 REST 客户端，它可以轻松地与其他服务进行通信。使用 Feign，您可以定义接口并自动将其映射到 HTTP 请求。</li> <li><code>Hystrix</code>：Hystrix 是一个容错和延迟容忍库，它可以帮助应用程序在出现故障或网络延迟时保持响应能力。它使用断路器模式来防止服务级联故障。</li> <li><code>Zuul</code>：Zuul 是一个 API 网关，它可以处理所有的客户端请求，并将它们路由到适当的微服务。它还可以处理身份验证、安全性、限流等其他功能。</li></ol> <h3 id="_2-3-服务注册和发现是什么意思-spring-cloud-如何实现服务注册发现"><a href="#_2-3-服务注册和发现是什么意思-spring-cloud-如何实现服务注册发现" class="header-anchor">#</a> 2.3 服务注册和发现是什么意思？Spring Cloud 如何实现服务注册发现？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>各种注册中心组件的原理和流程其实大体上类似</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220520105342636.png" alt="image-20220520105342636"></p> <p>核心的功能就一下几个 :</p> <ol><li>服务注册 : 服务启动的时候会将服务的信息注册到注册中心, 比如: 服务名称 , 服务的IP , 端口号等</li> <li>服务发现 : 服务调用方调用服务的时候, 根据服务名称从注册中心拉取服务列表 , 然后根据负载均衡策略 , 选择一个服务, 获取服务的IP和端口号, 发起远程调用</li> <li>服务状态监控 : 服务提供者会定时向注册中心发送心跳 , 注册中心也会主动向服务提供者发送心跳探测, 如果长时间没有接收到心跳, 就将服务实例从注册中心下线或者移除</li></ol> <p>使用的话, 首先需要部署注册中心服务 , 然后在我们自己的微服务中引入注册中心依赖, 然后再配置文件中配置注册中心地址 就可以了</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> leadnews<span class="token punctuation">-</span>admin
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token comment"># 注册中心地址</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 124.221.75.8<span class="token punctuation">:</span><span class="token number">8848</span>
      <span class="token comment"># 配置中心地址</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 124.221.75.8<span class="token punctuation">:</span><span class="token number">8848</span>
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_2-4-nacos、eureka的区别"><a href="#_2-4-nacos、eureka的区别" class="header-anchor">#</a> 2.4 nacos、eureka的区别？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p>① Nacos支持服务端主动检测提供者状态：临时实例采用心跳模式，非临时实例采用主动检测模式</p> <p>② 临时实例心跳不正常会被剔除，非临时实例则不会被剔除</p> <p>③ Nacos支持服务列表变更的消息推送模式，服务列表更新更及时</p> <p>④ Nacos集群默认采用AP方式，当集群中存在非临时实例时，采用CP模式；</p> <p>总结：</p> <ul><li><p>Eureka采用AP方式</p></li> <li><p>naocs默认是AP模式，可以采用CP模式</p></li></ul> <h3 id="_2-5-你们项目中微服务之间是如何通讯的"><a href="#_2-5-你们项目中微服务之间是如何通讯的" class="header-anchor">#</a> 2.5 你们项目中微服务之间是如何通讯的?</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆</p></blockquote> <p>1．同步通信：通过Feign发送http请求调用</p> <p>2．异步：消息队列，如RabbitMq、KafKa等</p> <h3 id="_2-6-你们项目负载均衡如何实现的"><a href="#_2-6-你们项目负载均衡如何实现的" class="header-anchor">#</a> 2.6 你们项目负载均衡如何实现的 ?</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>服务调用过程中的负载均衡一般使用SpringCloud的Ribbon 组件实现  , Feign的底层已经自动集成了Ribbon  , 使用起来非常简单</p> <p>客户端调用的话一般会通过网关, 通过网关实现请求的路由和负载均衡</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token comment"># 平台管理</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> wemedia
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//leadnews<span class="token punctuation">-</span>wemedia
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/wemedia/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> StripPrefix= 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-7-ribbon负载均衡策略有哪些-如果想自定义负载均衡策略如何实现"><a href="#_2-7-ribbon负载均衡策略有哪些-如果想自定义负载均衡策略如何实现" class="header-anchor">#</a> 2.7 Ribbon负载均衡策略有哪些 ? 如果想自定义负载均衡策略如何实现 ?</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p>常用的负载均衡算法：</p> <p>1、RoundRobinRule：简单轮询服务列表来选择服务器</p> <p>2、AvailabilityFilteringRule：对以下两种服务器进行忽略：</p> <p>（1）在默认情况下，这台服务器如果3次连接失败，这台服务器就会被设置为“短路”状态。短路状态将持续30秒，如果再次连接失败，短路的持续时间就会几何级地增加。</p> <p>（2）并发数过高的服务器、如果一个服务器的并发连接数过高，配置了AvailabilityFilteringRule规则的客户端也会将其忽略。并发连接数的上限，可以由客户端的<clientName>.<clientConfigNameSpace>ActiveConnectionsLimit属性进行配置。</clientConfigNameSpace></clientName></p> <p>3、WeightedResponseTimeRule：   为每一个服务器赋予一个权重值。服务器响应时间越长，这个服务器的权重就越小。这个规则会随机选择服务器，这个权重值会影响服务器的选择。</p> <p>4、<strong>ZoneAvoidanceRule</strong>：以区域可用的服务器为基础进行服务器的选择。使用Zone对服务器进行分类，这个Zone可以理解为一个机房、一个机架等。</p> <p>而后再对Zone内的多个服务做轮询。它是Ribbon默认的负载均衡规则。</p> <p>5、BestAvailableRule：忽略那些短路的服务器，并选择并发数较低的服务器。</p> <p>6、RandomRule：  随机选择一个可用的服务器。</p> <p>7、RetryRule：重试机制的选择逻辑。</p> <p>默认的负载均衡算法：ZoneAvoidanceRule</p> <p><strong>自定义负载均衡</strong></p> <p>如果想要自定义负载均衡 , 可以自己创建类实现IRule接口 , 然后再通过配置类或者配置文件配置即可 :</p> <p>通过定义IRule实现可以修改负载均衡规则，有两种方式：</p> <ol><li>代码方式：在order-service中的OrderApplication类中，定义一个新的IRule：</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">IRule</span> <span class="token function">randomRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RandomRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>配置文件方式：在order-service的application.yml文件中，添加新的配置也可以修改规则：</li></ol> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">userservice</span><span class="token punctuation">:</span> <span class="token comment"># 给某个微服务配置负载均衡规则，这里是userservice服务</span>
  <span class="token key atrule">ribbon</span><span class="token punctuation">:</span>
    <span class="token key atrule">NFLoadBalancerRuleClassName</span><span class="token punctuation">:</span> com.netflix.loadbalancer.RandomRule <span class="token comment"># 负载均衡规则 </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-8什么是spring-cloud-gateway以及在你们的项目中如何去应用该组件的"><a href="#_2-8什么是spring-cloud-gateway以及在你们的项目中如何去应用该组件的" class="header-anchor">#</a> 2.8什么是Spring Cloud Gateway以及在你们的项目中如何去应用该组件的？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>Spring Cloud Gateway：是Spring Cloud中所提供的一个服务网关组件，是整个微服务的统一入口，在服务网关中可以实现请求路由、统一的日志记录，流量监控、权限校验等一系列的相关功能！</p> <p>项目应用：权限的校验</p> <p>具体实现思路：使用Spring Cloud Gateway中的全局过滤器拦截请求(GlobalFilter、Order)，从请求头中获取token，然后解析token。如果可以进行正常解析，此时进行放行；如果解析不到直接返回。</p> <h3 id="_2-9-你们项目的配置文件是怎么管理的"><a href="#_2-9-你们项目的配置文件是怎么管理的" class="header-anchor">#</a> 2.9 你们项目的配置文件是怎么管理的 ?</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>大部分的固定的配置文件都放在服务本地 , 一些根据环境不同可能会变化的部分, 放到Nacos中</p> <p>Naocs中主要存放的是各个微服务共享的配置，需要随着需求动态变更的配置。</p> <h3 id="_2-10-你们项目中有没有做过限流-怎么做的"><a href="#_2-10-你们项目中有没有做过限流-怎么做的" class="header-anchor">#</a> 2.10 你们项目中有没有做过限流 ? 怎么做的 ?</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>常见的限流算法：<strong>漏桶算法</strong>、<strong>令牌桶算法</strong></p> <p>漏桶算法：漏桶算法其实很简单，可以粗略的认为就是注水漏水过程，往桶中以一定速率流出水，以任意速率流入水，当水超过桶流量则丢弃，因为桶容量是不变的，保证了整体的速率。</p> <p>如下图所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220823223012283.png" alt="image-20220823223012283"></p> <p>令牌桶算法：令牌桶是一个存放固定容量令牌的桶，按照固定速率r往桶里添加令牌；桶中最多存放b个令牌，当桶满时，新添加的令牌被丢弃；当一个请求达到时，会尝试从桶中获取令牌；如果有，则继续处理请求；如果没有则排队等待或者直接丢弃；可以发现，漏桶算法的流出速率恒定，而令牌桶算法的流</p> <p>出速率却有可能大于r；</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220823222550372.png" alt="image-20220823222550372"></p> <p>从作用上来说，漏桶和令牌桶算法最明显的区别就是是否允许突发流量(burst)的处理，漏桶算法能够强行限制数据的实时传输（处理）速率，对突发流量不做额外处理；而令牌桶算法能够在限制数据的平均传输速率的同时允许某种程度的突发传输。</p> <p><strong>限流算法区别</strong></p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220823223142337.png" alt="image-20220823223142337"></p> <p>参考回答：</p> <p>我们项目的流量还是比较大的，我们项目中用的令牌桶算法来进行限流的，在gateway中进行设置。</p> <p>令牌桶是一个存放固定容量令牌的桶，按照固定速率r往桶里添加令牌；桶中最多存放b个令牌，当桶满时，新添加的令牌被丢弃；当一个请求达到时，会尝试从桶中获取令牌；如果有，则继续处理请求；如果没有则排队等待或者直接丢弃；可以发现，漏桶算法的流出速率恒定，而令牌桶算法的流出速率却有可能大于r； 也就说对于突发流量令牌桶也能应付。</p> <p>具体使用是，在网关路由中进行过滤器配置，可以设置桶的带下，和固定速率。我们通常也会按照用户访问的ip进行限制，这个令牌需要存入redis，所以也需要集成redis使用。</p> <p>详细使用令牌桶算法限流，详细查看资料中的《网关限流》讲义</p> <h3 id="_2-11-断路器-熔断器用过嘛-断路器的状态有哪些"><a href="#_2-11-断路器-熔断器用过嘛-断路器的状态有哪些" class="header-anchor">#</a> 2.11 断路器/熔断器用过嘛 ? 断路器的状态有哪些 ？</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>我们项目中使用Hystrix实现的断路器  ,默认是关闭的，如果需要开启需要在引导类上添加注解：</p> <p><code>@EnableCircuitBreaker</code></p> <p>断路器状态机包括三个状态：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220520113844464.png" alt="image-20220520113844464"></p> <ul><li>closed：关闭状态，断路器放行所有请求，并开始统计异常比例、慢请求比例。超过阈值则切换到open状态
<ul><li>请求错误率超过 5%（默认）</li></ul></li> <li>open：打开状态，服务调用被<strong>熔断</strong>，访问被熔断服务的请求会被拒绝，快速失败，直接走降级逻辑。Open状态5秒后（默认值）会进入half-open状态</li> <li>half-open：半开状态，放行一次请求，根据执行结果来判断接下来的操作。
<ul><li>请求成功：则切换到closed状态</li> <li>请求失败：则切换到open状态</li></ul></li></ul> <h3 id="_2-12-你们项目中有做过服务降级嘛"><a href="#_2-12-你们项目中有做过服务降级嘛" class="header-anchor">#</a> 2.12 你们项目中有做过服务降级嘛 ?</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>我们项目中涉及到服务调用得地方都会定义降级, 一般降级逻辑就是返回默认值  , 降级的实现也非常简单 , 就是创建一个类实现<code>FallbackFactory</code>接口 , 然后再对应的Feign客户端接口上面 , 通过@FeignClient指定降级类</p> <h3 id="_2-13-你们的微服务是怎么监控的"><a href="#_2-13-你们的微服务是怎么监控的" class="header-anchor">#</a> 2.13 你们的微服务是怎么监控的？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>skywalking</p> <p>请查看资料中的skywalking的讲义</p> <h2 id="_3-分布式事务篇"><a href="#_3-分布式事务篇" class="header-anchor">#</a> 3 分布式事务篇</h2> <h3 id="_3-1-什么是分布式事务"><a href="#_3-1-什么是分布式事务" class="header-anchor">#</a> 3.1 什么是分布式事务？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>概述：在分布式系统中，一个业务因为跨越不同数据库或者跨越不同微服务而包含多个子事务，要求所有子事务同时成功或失败，这就是分布式事务。</p> <p>如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001744594.png" alt="image-20220824001744594"></p> <p>某电商系统的下单操作，需要请求三个服务来完成，这三个服务分别是：订单服务，账户服务，库存服务。当订单生成完毕以后，就需要分别请求账户服务和库存服务进行进行账户余额的扣减和库存扣减。假设都扣减成功了，此时在执行下单的后续操作时出现了问题，那么订单数据库就进行事务回滚，订单生成失败，而账户余额和扣减则都扣减成功了。这就出现了问题，而分布式事务就是解决上述这种不一致问题的。</p> <h3 id="_3-2-哪些场景下都会产生分布式事务"><a href="#_3-2-哪些场景下都会产生分布式事务" class="header-anchor">#</a> 3.2 哪些场景下都会产生分布式事务？</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p><strong>场景1：跨库事务</strong></p> <p>跨库事务指的是，一个应用某个功能需要操作多个库，不同的库中存储不同的业务数据。如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001721789.png" alt="image-20220824001721789"></p> <p><strong>场景二：分库分表</strong></p> <p>通常一个库数据量比较大或者预期未来的数据量比较大，都会进行水平拆分，也就是分库分表。如下图，将数据库B拆分成了2个库：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001809018.png" alt="image-20220824001809018"></p> <p>对于分库分表的情况，一般开发人员都会使用一些数据库中间件来降低sql操作的复杂性。</p> <p>如，对于sql：insert into user(id,name) values (1,&quot;tianshouzhi&quot;),(2,&quot;wangxiaoxiao&quot;)。这条sql是操作单库的语法，单库情况下，可以保证事务的一致性。</p> <p>但是由于现在进行了分库分表，开发人员希望将1号记录插入分库1，2号记录插入分库2。所以数据库中间件要将其改写为2条sql，分别插入两个不同的分库，此时要保证两个库要不都成功，要不都失败，因此基本上所有的数据库中间件都面临着分布式事务的问题。</p> <p><strong>场景三：跨服务事务</strong></p> <p>跨服务事务指的是，一个应用某个功能需要调用多个微服务进行实现，不同的微服务操作的是不同的数据库。如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001829706.png" alt="image-20220824001829706"></p> <p>Service A完成某个功能需要直接操作数据库，同时需要调用Service B和Service C，而Service B又同时操作了2个数据库，Service C也操作了一个库。需要保证这些跨服务的对多个数据库的操作要不都成功，要不都失败，实际上这可能是最典型的分布式事务场景。</p> <h3 id="_3-3-什么是cap理论"><a href="#_3-3-什么是cap理论" class="header-anchor">#</a> 3.3 什么是CAP理论？</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>CAP定理是由加州大学伯克利分校Eric Brewer教授提出来的，他指出WEB服务无法同时满足一下3个属性：</p> <p>1、一致性(Consistency) ： 更新操作成功并返回客户端完成后，所有节点在同一时间的数据完全一致(强一致性)，不能存在中间状态。</p> <p>2、可用性(Availability) ： 系统提供的服务必须一直处于可用的状态，对于用户的每一个操作请求总是能够在有限的时间内返回结果。</p> <p>3、分区容错性(Partition tolerance) ： 分布式系统在遇到任何网络分区故障时，仍然需要能够保证对外提供满足一致性和可用性的服务，除非是整个网络环境都发生了故障。</p> <p>如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001910278.png" alt="image-20220824001910278"></p> <h3 id="_3-4-为什么分布式系统中无法同时保证一致性和可用性"><a href="#_3-4-为什么分布式系统中无法同时保证一致性和可用性" class="header-anchor">#</a> 3.4 为什么分布式系统中无法同时保证一致性和可用性？</h3> <blockquote><p>难易程度：☆☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>对于分布式系统而言，各节点之间一定会存在网络交互，首先网络存在延迟，其次无法100%确保网络的可用，因此可以认为分区网络故障不可避免。
在此条件下，如果要保证各节点的一致性，就必须在一个节点数据变更时，将数据同步给另一个节点，同时，在数据同步过程中，被同步的节点是不能对外提供服务的，否则就会出现数据不一致。而节点不可对外提供服务，就违背了可用性。
所以，在存在系统分区的场景下，可用性和一致性无法同时满足</p> <h3 id="_3-5-什么是base理论"><a href="#_3-5-什么是base理论" class="header-anchor">#</a> 3.5 什么是BASE理论？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>CAP是分布式系统设计理论，BASE是CAP理论中AP方案的延伸，核心思想是即使无法做到强一致性（StrongConsistency，CAP的一致性就是强一致性），但应用可以采用适合的方式达到最终一致性（Eventual Consitency）。它的思想包含三方面：</p> <p>1、Basically Available（基本可用）：基本可用是指分布式系统在出现不可预知的故障的时候，允许损失部分可用性，但不等于系统不可用。</p> <p>2、Soft state（软状态）：即是指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时。</p> <p>3、Eventually consistent（最终一致性）：强调系统中所有的数据副本，在经过一段时间的同步后，最终能够达到一个一致的状态。其本质是需要系统</p> <p>保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性。</p> <h3 id="_3-6-分布式事务的常见的解决方案有哪些"><a href="#_3-6-分布式事务的常见的解决方案有哪些" class="header-anchor">#</a> 3.6 分布式事务的常见的解决方案有哪些？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p><strong>方案一：2PC</strong></p> <p>两阶段提交又称2PC，2PC是一个非常经典的强一致、中心化的原子提交协议 。</p> <p>中心化是指协议中有两类节点：一个是中心化协调者节点 （coordinator）和 N个参与者节点 （partcipant）。</p> <p>两个阶段 ：</p> <p>1、第一阶段：投票阶段</p> <p>2、第二阶段：提交/执行阶段。</p> <p>举例订单服务A，需要调用支付服务B 去支付，支付成功则处理订单状态为待发货状态，否则就需要将购物订单处理为失败状态。 那么看2PC阶段是如何处</p> <p>理的。</p> <p>阶段一：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824001942000.png" alt="image-20220824001942000"></p> <p>阶段一执行流程：</p> <p>1、事务询问协调者向所有的参与者发送事务预处理请求，称之为Prepare，并开始等待各参与者的响应。</p> <p>2、执行本地事务各个参与者节点执行本地事务操作，但在执行完成后并不会真正提交数据库本地事务，而是先向协调者报告说：“我这边可以处理了/我这边不能处理”。</p> <p>3、各参与者向协调者反馈事务询问的响应如果参与者成功执行了事务操作,那么就反馈给协调者Yes响应,表示事务可以执行,如果没有参与者成功执行事务,那么就反馈给协调者 No 响应,表示事务不可以执行。</p> <p>阶段二：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002000947.png" alt="image-20220824002000947"></p> <p>阶段二执行流程：</p> <p>1、所有的参与者反馈给协调者的信息都是Yes,那么就会执行事务提交协调者向所有参与者节点发出Commit请求</p> <p>2、事务提交参与者收到Commit请求之后,就会正式执行本地事务Commit操作,并在完成提交之后释放整个事务执行期间占用的事务资源。</p> <p><strong>方案二：TCC</strong></p> <p>TCC（Try-Confirm-Cancel）又称补偿事务。其核心思想是：&quot;针对每个操作都要注册一个与其对应的确认和补偿（撤销操作）&quot;。</p> <p>它分为三个操作：</p> <p>1、Try阶段：主要是对业务系统做检测及资源预留。</p> <p>2、Confirm阶段：确认执行业务操作。</p> <p>3、Cancel阶段：取消执行业务操作。</p> <p>如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002205655.png" alt="image-20220824002205655"></p> <p>TCC事务的处理流程与2PC两阶段提交类似，不过2PC通常都是在跨库的DB层面，而TCC本质上就是一个应用层面的2PC，需要通过业务逻辑来实现。这种分布式事务的实现方式的优势在于，可以让应用自己定义数据库操作的粒度，使得降低锁冲突、提高吞吐量成为可能。 不足之处则在于对应用的侵入性非常强，业务逻辑的每个分支都需要实现try、confirm、cancel三个操作。此外，其实现难度也比较大，需要按照网络状态、系统故障等不同的失败原因实现不同的回滚策略。为了满足一致性的要求，confirm和cancel接口还必须实现幂等。</p> <p><strong>方案三：MQ分布式事务</strong></p> <p>上面的三种分布式事务的解决方案适用于对数据一致性要求很高的场景。如果数据强一致性要求没那么高，可以采用消息中间件（MQ）实现事务最终一致。 在支付系统中，常常使用的分布式事务解决方案就是基于MQ实现的，它对数据强一致性要求没那么高，但要求数据最终一致即可。</p> <p>例如：向借呗申请借钱，借呗审核通过后支付宝的余额才会增加，但借呗和支付宝有可能不是同一个系统，这时候如何实现事务呢？实现方案如下图：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002222856.png" alt="image-20220824002222856"></p> <p>执行流程如下所示：</p> <p>1、找花呗借钱</p> <p>2、花呗借钱审核通过，同步生成借款单</p> <p>3、借款单生成后，向MQ发送消息，通知支付宝转账</p> <p>4、支付宝读取MQ消息，并增加账户余额</p> <p>上图最复杂的其实是如何保障2、3在同一个事务中执行（本地事务和MQ消息发送在同一个事务执行），借款结束后，借呗数据处理就完成了，接下来支付宝才能读到消息，然后执行余额增加，这才完成整个操作。如果中途操作发生异常，例如支付宝余额增加发生问题怎么办？此时需要人工解决，没有特别好的办法，但这种事故概率极低。</p> <h3 id="_3-7-seata的架构是什么"><a href="#_3-7-seata的架构是什么" class="header-anchor">#</a> 3.7 Seata的架构是什么？</h3> <blockquote><p>难易程度：☆☆</p> <p>出现频率：☆☆</p></blockquote> <p>Seata事务管理中有三个重要的角色：</p> <p>1、TC (Transaction Coordinator) -事务协调者：维护全局和分支事务的状态，协调全局事务提交或回滚。</p> <p>2、TM (Transaction Manager) -事务管理器：定义全局事务的范围、开始全局事务、提交或回滚全局事务。</p> <p>3、RM (Resource Manager) -资源管理器：管理分支事务处理的资源，与TC交谈以注册分支事务和报告分支事务的状态，并驱动分支事务提交或回滚。</p> <p>如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002239492.png" alt="image-20220824002239492"></p> <h3 id="_3-8-xa模式的工作流程是什么"><a href="#_3-8-xa模式的工作流程是什么" class="header-anchor">#</a> 3.8 XA模式的工作流程是什么？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆</p></blockquote> <p>xa模式整个工作流程图如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002258453.png" alt="image-20220824002258453"></p> <p>分为两个阶段：</p> <p>1、RM一阶段的工作：① 注册分支事务到TC	② 执行分支业务sql但不提交	③ 报告执行状态到TC</p> <p>2、TC二阶段的工作：TC检测各分支事务执行状态	①如果都成功，通知所有RM提交事务	②如果有失败，通知所有RM回滚事务</p> <p>3、RM二阶段的工作：接收TC指令，提交或回滚事务</p> <p>xa模式牺牲了可用性，保证了强一致性</p> <h3 id="_3-9-at模型的工作原理是什么"><a href="#_3-9-at模型的工作原理是什么" class="header-anchor">#</a> 3.9 AT模型的工作原理是什么？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆☆</p></blockquote> <p>at模式的整个工作流程图如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002317259.png" alt="image-20220824002317259"></p> <p>1、阶段一RM的工作：① 注册分支事务  ② 记录undo-log（数据快照）③ 执行业务sql并提交 ④报告事务状态</p> <p>2、阶段二提交时RM的工作：删除undo-log即可</p> <p>3、阶段二回滚时RM的工作：根据undo-log恢复数据到更新前</p> <p>at模式牺牲了一致性，保证了可用性</p> <h3 id="_3-10-tcc模型的工作原理是什么"><a href="#_3-10-tcc模型的工作原理是什么" class="header-anchor">#</a> 3.10 TCC模型的工作原理是什么？</h3> <blockquote><p>难易程度：☆☆☆</p> <p>出现频率：☆☆☆</p></blockquote> <p>TCC模式与AT模式非常相似，每阶段都是独立事务，不同的是TCC通过人工编码来实现数据恢复。需要实现三个方法：</p> <p>1、Try：资源的检测和预留；</p> <p>2、Confirm：完成资源操作业务；要求 Try 成功 Confirm 一定要能成功。</p> <p>3、Cancel：预留资源释放，可以理解为try的反向操作。</p> <p>Seata中的tcc模型的执行流程如下所示：</p> <p><img src="https://raw.githubusercontent.com/demo223/pictures/master/img/image-20220824002343821.png" alt="image-20220824002343821"></p> <p>1、阶段一RM的工作：① 注册分支事务  ② 执行try操作预留资源  ④报告事务状态</p> <p>2、阶段二提交时RM的工作：根据各分支事务的状态执行confirm或者cancel</p> <h2 id="_4-面试现场"><a href="#_4-面试现场" class="header-anchor">#</a> 4 面试现场</h2> <h3 id="_4-1-springboot"><a href="#_4-1-springboot" class="header-anchor">#</a> 4.1 Springboot</h3> <blockquote><p><strong>面试官</strong>：讲一讲SpringBoot自动装配的原理？</p> <p><strong>候选人</strong>：</p> <p>嗯，好的，它是这样的。</p> <p>在Spring Boot项目中的引导类上有一个注解@SpringBootApplication，这个注解是对三个注解进行了封装，分别是：</p> <ul><li><p>@SpringBootConfiguration</p></li> <li><p>@EnableAutoConfiguration</p></li> <li><p>@ComponentScan</p></li></ul> <p>其中<code>@EnableAutoConfiguration</code>是实现自动化配置的核心注解。</p> <p>该注解通过<code>@Import</code>注解导入对应的配置选择器。关键的是内部就是读取了该项目和该项目引用的Jar包的的classpath路径下<strong>META-INF/spring.factories</strong>文件中的所配置的类的全类名。</p> <p>在这些配置类中所定义的Bean会根据条件注解所<strong>指定的条件来决定</strong>是否需要将其导入到Spring容器中。</p> <p>一般条件判断会有像<code>@ConditionalOnClass</code>这样的注解，判断是否有对应的class文件，如果有则加载该类，把这个配置类的所有的Bean放入spring容器中使用。</p> <p><strong>面试官</strong>：讲一讲SpringBoot启动流程</p> <p><strong>候选人</strong>：</p> <p>嗯，是这样的</p> <p>springboot项目在启动的时候, 首先会执行启动引导类里面的</p> <p><code>SpringApplication.run(AdminApplication.class, args)</code>方法</p> <p>这个run方法主要做的事情可以分为三个部分 :</p> <p>第一部分进行SpringApplication的初始化模块，配置一些基本的环境变量、资源、构造器、监听器</p> <p>第二部分实现了应用具体的启动方案，包括启动流程的监听模块、加载配置环境模块、及核心的创建上下文环境模块</p> <p>第三部分是自动化配置模块，该模块作为springboot自动配置核心</p> <p><strong>面试官</strong>：你们常用的SpringBoot起步依赖有哪些</p> <p><strong>候选人</strong>：</p> <p>嗯，现在使用springboot的情况比较多，这些起步依赖也用过很多</p> <p>比如：关于redis、mabatis-plus、test、mongodb、apqp等等吧</p> <p><strong>面试官</strong>：springBoot支持的配置文件有哪些 ? 加载顺序是什么样的</p> <p><strong>候选人</strong>：</p> <p>嗯，这个主要支持文件类型的加载，yml和properties文件，优先加载yml，侯然后加载properties</p> <p>如果有相同的配置，先加载的会被后加载的文件覆盖</p> <p>假如在启动项目的时候给了启动参数，则最后生效，会覆盖前面所有相同的配置</p> <p><code>java -jar --server.port=8089 xx.jar</code></p> <p><strong>面试官</strong>：运行一个SpringBoot项目有哪些方式</p> <p><strong>候选人</strong>：</p> <p>嗯，这个也有很种方式</p> <p>第一种，也是比较常见的直接使用jar -jar 运行</p> <p>第二种是可以配置插件 , 将springboot项目打war包, 部署到Tomcat中运行</p> <p>第三种是直接用maven插件运行 maven spring-boot：run运行项目</p> <p><strong>面试官</strong>：Spring Boot的核心注解是哪个？他由哪几个注解组成的？</p> <p><strong>候选人</strong>：</p> <p>嗯~~</p> <p>Spring Boot的核心注解是@SpringBootApplication , 他由几个注解组成 :</p> <ul><li>@SpringBootConfiguration： 组合了- @Configuration注解，实现配置文件的功能；</li> <li>@EnableAutoConfiguration：打开自动配置的功能，也可以关闭某个自动配置的选项</li> <li>@ComponentScan：Spring组件扫描</li></ul> <p><strong>面试官</strong>：你们项目中使用的SpringBoot是哪个版本 ?</p> <p><strong>候选人</strong>：</p> <p>嗯，我们的项目中使用的</p> <ul><li>SpringBoot : 2.3.9.RELEASE</li> <li>SpringCloud : Hoxton.SR10</li> <li>SpringCloudAlibaba : 2.2.5.RELEASE</li></ul> <p><strong>面试官</strong>：Spring Boot如何定义多套不同环境配置？</p> <p><strong>候选人</strong>：</p> <p>这个我们项目提供多套配置文件，比如说application-dev.properties、application-prod.properties等等</p> <p>然后在applcation.properties文件中指定当前的环境<strong>spring.profiles.active=prod</strong>,这时候读取的就是application-prod.properties文件。</p></blockquote> <h3 id="_4-2-springcloud"><a href="#_4-2-springcloud" class="header-anchor">#</a> 4.2 SpringCloud</h3> <blockquote><p><strong>面试官</strong>：什么是微服务?微服务的优缺点是什么?</p> <p><strong>候选人</strong>：</p> <p>嗯~~</p> <p>微服务就是一个独立的职责单一的服务应用程序，一个模块</p> <p><strong>优点</strong>：松耦合，聚焦单一业务功能，无关开发语言，团队规模降低。在开发中，不需要了解多有业务，只专注于当前功能，便利集中，功能小而精。微服务一个功能受损，对其他功能影响并不是太大，可以快速定位问题。微服务只专注于当前业务逻辑代码，不会和 html、css 或其他界面进行混合。可以灵活搭配技术，独立性比较好。</p> <p><strong>缺点</strong>：随着服务数量增加，管理复杂，部署复杂，服务器需要增多，服务通信和调用压力增大，运维工程师压力增大，人力资源增多，系统依赖增强，数据一致性，性能监控。</p> <p><strong>面试官</strong>：Spring Cloud 5大组件有哪些？</p> <p><strong>候选人</strong>：</p> <p>早期我们一般认为的Spring Cloud五大组件是</p> <ul><li>Eureka   : 注册中心</li> <li>Ribbon  : 负载均衡</li> <li>Feign     : 远程调用</li> <li>Hystrix :  服务熔断</li> <li>Zuul/Gateway  : 网关</li></ul> <p>随着SpringCloudAlibba在国内兴起 , 我们项目中使用了一些阿里巴巴的组件</p> <ul><li><p>注册中心/配置中心 Nacos</p></li> <li><p>负载均衡 Ribbon</p></li> <li><p>服务调用 Feign</p></li> <li><p>服务保护 sentinel</p></li> <li><p>服务网关 Gateway</p></li></ul> <p><strong>面试官</strong>：服务注册和发现是什么意思？Spring Cloud 如何实现服务注册发现？</p> <p><strong>候选人</strong>：</p> <p>我理解的是主要三块大功能，分别是服务注册 、服务发现、服务状态监控</p> <ol><li>服务注册 : 服务启动的时候会将服务的信息注册到注册中心, 比如: 服务名称 , 服务的IP , 端口号等</li> <li>服务发现 : 服务调用方调用服务的时候, 根据服务名称从注册中心拉取服务列表 , 然后根据负载均衡策略 , 选择一个服务, 获取服务的IP和端口号, 发起远程调用</li> <li>服务状态监控 : 服务提供者会定时向注册中心发送心跳 , 注册中心也会主动向服务提供者发送心跳探测, 如果长时间没有接收到心跳, 就将服务实例从注册中心下线或者移除</li></ol> <p>使用的话, 首先需要部署注册中心服务 , 然后在我们自己的微服务中引入注册中心依赖, 然后再配置文件中配置注册中心地址 就可以了</p> <p><strong>面试官</strong>：nacos、eureka的区别？</p> <p><strong>候选人</strong>：</p> <p>我们项目中采用的nacos作为注册中心的，同时nacos也可以做为配置中心使用，而eureka只是有注册中心功能，不过关于注册中心它们也有一些不同</p> <p>① Nacos支持服务端主动检测提供者状态：临时实例采用心跳模式，非临时实例采用主动检测模式</p> <p>② 临时实例心跳不正常会被剔除，非临时实例则不会被剔除</p> <p>③ Nacos支持服务列表变更的消息推送模式，服务列表更新更及时</p> <p>④ Nacos集群默认采用AP方式，当集群中存在非临时实例时，采用CP模式；</p> <p>也就说，Eureka采用AP方式，而naocs默认是AP模式，也可以采用CP模式</p> <p><strong>面试官</strong>：你们项目中微服务之间是如何通讯的?</p> <p><strong>候选人</strong>：</p> <p>嗯，如果是同步通信的话，我们一般使用springCloud的组件Feign发送http请求调用</p> <p>如果是异步通信的话，使用的消息队列中间件，如RabbitMq、Kafka这些都用过</p> <p><strong>面试官</strong>：你们项目负载均衡如何实现的 ?</p> <p><strong>候选人</strong>：</p> <p>是这样~~</p> <p>在服务调用过程中的负载均衡一般使用SpringCloud的Ribbon 组件实现  , Feign的底层已经自动集成了Ribbon  , 使用起来非常简单</p> <p>客户端调用的话一般会通过网关, 通过网关实现请求的路由和负载均衡</p> <p><strong>面试官</strong>：Ribbon负载均衡策略有哪些 ? 如果想自定义负载均衡策略如何实现 ?</p> <p><strong>候选人</strong>：</p> <p>嗯，是这样~~</p> <p>Ribbon提供了很多负载均衡算法，比如有轮询（RoundRobinRule）、随机策略（RandomRule）、还可以按照权重（WeightedResponseTimeRule）进行设置，默认采用的是区域可用的服务器为基础进行服务器的选择（ZoneAvoidanceRule），底层采用的一个区域内的机器进行轮询</p> <p>如果想要自定义负载均衡策略可以有两种方式</p> <p>第一是：定义一个@Bean，返回值是IRule，可以采用不同的实现来设置不同的策略，这个全局生效的。我们一般也很少采用</p> <p>第二是：通过配置文件的方式添加某一个服务的负载均衡策略，这种方式比较常见</p> <p><strong>面试官</strong>：什么是Spring Cloud Gateway以及在你们的项目中如何去应用该组件的？</p> <p><strong>候选人</strong>：</p> <p>Spring Cloud Gateway是Spring Cloud中所提供的一个服务网关组件，是整个微服务的统一入口，在服务网关中可以实现请求路由、统一的日志记录，流量监控、权限校验等一系列的相关功能！</p> <p>我们在项目使用网关主要是权限校验</p> <p>具体实现思路：使用Spring Cloud Gateway中的全局过滤器拦截请求(GlobalFilter、Order)，从请求头中获取token，然后解析token。如果可以进行正常解析，此时进行放行；如果解析不到直接返回。</p> <p><strong>面试官</strong>：你们项目的配置文件是怎么管理的 ?</p> <p><strong>候选人</strong>：</p> <p>嗯，我们的项目中大部分的固定的配置文件都放在服务本地 , 一些根据环境不同可能会变化的部分, 放到Nacos中</p> <p><strong>面试官</strong>：你们项目中有没有做过限流 ? 怎么做的 ?</p> <p><strong>候选人</strong>：</p> <p>回答方式一：</p> <p>我们的项目目前访问量不大，并没设置限流操作，不过我知道怎么去用，常见的限流算法：<strong>漏桶算法</strong>、<strong>令牌桶算法</strong></p> <p>漏桶算法：漏桶算法其实很简单，可以粗略的认为就是注水漏水过程，往桶中以一定速率流出水，以任意速率流入水，当水超过桶流量则丢弃，因为桶容量是不变的，保证了整体的速率。</p> <p>令牌桶算法：令牌桶是一个存放固定容量令牌的桶，按照固定速率r往桶里添加令牌；桶中最多存放b个令牌，当桶满时，新添加的令牌被丢弃；当一个请求达到时，会尝试从桶中获取令牌；如果有，则继续处理请求；如果没有则排队等待或者直接丢弃；可以发现，漏桶算法的流出速率恒定，而令牌桶算法的流出速率却有可能大于r；</p> <p>从作用上来说，漏桶和令牌桶算法最明显的区别就是是否允许突发流量(burst)的处理，漏桶算法能够强行限制数据的实时传输（处理）速率，对突发流量不做额外处理；而令牌桶算法能够在限制数据的平均传输速率的同时允许某种程度的突发传输。</p> <p>回答方式二：</p> <p>我们项目的流量还是比较大的，我们项目中用的令牌桶算法来进行限流的，在gateway中进行设置。</p> <p>令牌桶是一个存放固定容量令牌的桶，按照固定速率r往桶里添加令牌；桶中最多存放b个令牌，当桶满时，新添加的令牌被丢弃；当一个请求达到时，会尝试从桶中获取令牌；如果有，则继续处理请求；如果没有则排队等待或者直接丢弃；可以发现，漏桶算法的流出速率恒定，而令牌桶算法的流出速率却有可能大于r； 也就说对于突发流量令牌桶也能应付。</p> <p>具体使用是，在网关路由中进行过滤器配置，可以设置桶的带下，和固定速率。我们通常也会按照用户访问的ip进行限制，这个令牌需要存入redis，所以也需要集成redis使用。</p> <p><strong>面试官</strong>：断路器/熔断器用过嘛 ? 断路器的状态有哪些 ？</p> <p><strong>候选人</strong>：</p> <p>我们项目中使用Hystrix实现的断路器  ,默认是关闭的，如果需要开启需要在引导类上添加注解：</p> <p><code>@EnableCircuitBreaker</code></p> <p>断路器状态机包括三个状态：</p> <ul><li>closed：关闭状态，断路器放行所有请求，并开始统计异常比例、慢请求比例。超过阈值则切换到open状态</li> <li>通常一般判断是服务响应时间太久会进行开启</li> <li>open：打开状态，服务调用被<strong>熔断</strong>，访问被熔断服务的请求会被拒绝，快速失败，直接走降级逻辑。Open状态5秒后（默认值）会进入half-open状态</li> <li>half-open：半开状态，放行一次请求，根据执行结果来判断接下来的操作。</li> <li>请求成功：则切换到closed状态</li> <li>请求失败：则切换到open状态</li></ul> <p><strong>面试官</strong>：你们项目中有做过服务降级嘛 ?</p> <p><strong>候选人</strong>：</p> <p>我们项目中涉及到服务调用得地方都会定义降级, 一般降级逻辑就是返回默认值  , 降级的实现也非常简单 , 就是创建一个类实现<code>FallbackFactory</code>接口 , 然后再对应的Feign客户端接口上面 , 通过@FeignClient指定降级类</p> <p><strong>面试官</strong>：你们的微服务是这么监控的？</p> <p><strong>候选人</strong>：</p> <p>嗯，有的，因为我们的微服务也比较多，需要进行监控，我们采用的skywalking进行监控的</p> <p>skywalking主要可以监控接口、服务、物理实例的一些状态。特别是在压测的时候可以看到众多服务中哪些服务和接口比较慢，我们可以针对性的分析和优化。</p> <p>我们还在skywalking设置了告警规则，特别是在项目上线以后，如果报错，我们分别设置了可以给相关负责人发短信和发邮件，第一时间知道项目的bug情况，第一时间修复</p></blockquote> <h3 id="_4-3-分布式事务"><a href="#_4-3-分布式事务" class="header-anchor">#</a> 4.3 分布式事务</h3> <blockquote><p><strong>面试官</strong>：什么是分布式事务？</p> <p><strong>候选人</strong>：</p> <p>嗯，清楚的~</p> <p>分布式系统上一次大的操作由不同的小操作组成，这些小的操作分布在不同的服务节点上，且属于不同的应用，分布式事务需要保证这些小操作要么全部成功，要么全部失败。</p> <p><strong>面试官</strong>：哪些场景下都会产生分布式事务？</p> <p><strong>候选人</strong>：</p> <p>嗯，这个一般有两种情况</p> <p>第一个是跨库操作，一个应用某个功能需要操作多个库，不同的库中存储不同的业务数据</p> <p>第二个是跨服务事务，一个应用某个功能需要调用多个微服务进行实现，不同的微服务操作的是不同的数据库</p> <p>像我们的项目中更多的跨服务事务比较多。</p> <p><strong>面试官</strong>：什么是CAP理论？</p> <p><strong>候选人</strong>：</p> <p>CAP主要是在分布式项目下的一个理论。包含了三项，一致性、可用性、分区容错性</p> <ul><li><p>一致性(Consistency)是指更新操作成功并返回客户端完成后，所有节点在同一时间的数据完全一致(强一致性)，不能存在中间状态。</p></li> <li><p>可用性(Availability) 是指系统提供的服务必须一直处于可用的状态，对于用户的每一个操作请求总是能够在有限的时间内返回结果。</p></li> <li><p>分区容错性(Partition tolerance) 是指分布式系统在遇到任何网络分区故障时，仍然需要能够保证对外提供满足一致性和可用性的服务，除非是整个网络环境都发生了故障。</p></li></ul> <p><strong>面试官</strong>：为什么分布式系统中无法同时保证一致性和可用性？</p> <p><strong>候选人</strong>：</p> <p>嗯，是这样的~~</p> <p>首先一个前提，对于分布式系统而言，分区容错性是一个最基本的要求，因此基本上我们在设计分布式系统的时候只能从一致性（C）和可用性（A）之间进行取舍。</p> <p>如果保证了一致性（C）：对于节点N1和N2，当往N1里写数据时，N2上的操作必须被暂停，只有当N1同步数据到N2时才能对N2进行读写请求，在N2被暂停操作期间客户端提交的请求会收到失败或超时。显然，这与可用性是相悖的。</p> <p>如果保证了可用性（A）：那就不能暂停N2的读写操作，但同时N1在写数据的话，这就违背了一致性的要求。</p> <p><strong>面试官</strong>：什么是BASE理论？</p> <p><strong>候选人</strong>：</p> <p>嗯，这个也是CAP分布式系统设计理论</p> <p>BASE是CAP理论中AP方案的延伸，核心思想是即使无法做到强一致性（StrongConsistency，CAP的一致性就是强一致性），但应用可以采用适合的方式达到最终一致性（Eventual Consitency）。它的思想包含三方面：</p> <p>1、Basically Available（基本可用）：基本可用是指分布式系统在出现不可预知的故障的时候，允许损失部分可用性，但不等于系统不可用。</p> <p>2、Soft state（软状态）：即是指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时。</p> <p>3、Eventually consistent（最终一致性）：强调系统中所有的数据副本，在经过一段时间的同步后，最终能够达到一个一致的状态。其本质是需要系统保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性。</p> <p><strong>面试官</strong>：分布式事务的常见的解决方案有哪些？</p> <p><strong>候选人</strong>：</p> <p>嗯，这个有多种方案都可以解决分布式事务的问题。</p> <p>第一个是2PC两阶段提交</p> <p>1、第一阶段：投票阶段</p> <p>2、第二阶段：提交/执行阶段。</p> <p>举例订单服务A，需要调用支付服务B 去支付，支付成功则处理订单状态为待发货状态，否则就需要将购物订单处理为失败状态。 那么看2PC阶段是如何处理的。</p> <p>第二个方案是TCC</p> <p>TCC（Try-Confirm-Cancel）又称补偿事务。其核心思想是：&quot;针对每个操作都要注册一个与其对应的确认和补偿（撤销操作）&quot;。</p> <p>它分为三个操作：</p> <p>1、Try阶段：主要是对业务系统做检测及资源预留。</p> <p>2、Confirm阶段：确认执行业务操作。</p> <p>3、Cancel阶段：取消执行业务操作。</p> <p>比如说，转账，A向B转1000元</p> <p>try阶段主要是检查和冻结，检查A的余额是否足够，进行冻结操作，检查B的账户是否正常</p> <p>Confirm阶段，假如try阶段的检查和冻结都没问题，则AB都执行提交操作即可</p> <p>Cancel阶段，假如try阶段的检查和冻结有问题，则执行回滚操作</p> <p>第三，也可以采用MQ解决分布式事务</p> <p>上面的两种分布式事务的解决方案适用于对数据一致性要求很高的场景。如果数据强一致性要求没那么高，可以采用消息中间件（MQ）实现事务最终一致。 在支付系统中，常常使用的分布式事务解决方案就是基于MQ实现的，它对数据强一致性要求没那么高，但要求数据最终一致即可。</p> <p><strong>面试官</strong>：Seata的架构是什么？</p> <p><strong>候选人</strong>：</p> <p>Seata事务管理中有三个重要的角色：</p> <p>1、TC (Transaction Coordinator) -事务协调者：维护全局和分支事务的状态，协调全局事务提交或回滚。</p> <p>2、TM (Transaction Manager) -事务管理器：定义全局事务的范围、开始全局事务、提交或回滚全局事务。</p> <p>3、RM (Resource Manager) -资源管理器：管理分支事务处理的资源，与TC交谈以注册分支事务和报告分支事务的状态，并驱动分支事务提交或回滚。</p> <p><strong>面试官</strong>：XA模式的工作流程是什么？</p> <p><strong>候选人</strong>：</p> <p>嗯，seata的xa模式分为两个阶段：</p> <p>1、RM一阶段的工作：① 注册分支事务到TC	② 执行分支业务sql但不提交	③ 报告执行状态到TC</p> <p>2、TC二阶段的工作：TC检测各分支事务执行状态	①如果都成功，通知所有RM提交事务	②如果有失败，通知所有RM回滚事务</p> <p>3、RM二阶段的工作：接收TC指令，提交或回滚事务</p> <p>xa模式牺牲了可用性（需要互相等待，共同提交事务），保证了强一致性</p> <p><strong>面试官</strong>：AT模型的工作原理是什么？</p> <p><strong>候选人</strong>：</p> <p>嗯，seata的AT模型分为两个阶段：</p> <p>1、阶段一RM的工作：① 注册分支事务  ② 记录undo-log（数据快照）③ 执行业务sql并提交 ④报告事务状态</p> <p>2、阶段二提交时RM的工作：删除undo-log即可</p> <p>3、阶段二回滚时RM的工作：根据undo-log恢复数据到更新前</p> <p>at模式牺牲了一致性，保证了可用性</p> <p><strong>面试官</strong>：TCC模型的工作原理是什么？</p> <p><strong>候选人</strong>：</p> <p>TCC模式与AT模式非常相似，每阶段都是独立事务，不同的是TCC通过人工编码来实现数据恢复。需要实现三个方法：</p> <p>1、Try：资源的检测和预留；</p> <p>2、Confirm：完成资源操作业务；要求 Try 成功 Confirm 一定要能成功。</p> <p>3、Cancel：预留资源释放，可以理解为try的反向操作。</p> <p>Seata中的tcc模型的执行流程也是两步</p> <p>1、阶段一RM的工作：① 注册分支事务  ② 执行try操作预留资源  ④报告事务状态</p> <p>2、阶段二提交时RM的工作：根据各分支事务的状态执行confirm或者cancel</p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">2023/10/29</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Java面试题/微服务面试题/MQ系列面试题.html" class="prev">
        MQ系列面试题
      </a></span> <span class="next"><a href="/项目总结/Mybatis使用/Mybatis分页实现.html">
        Mybatis分页实现
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a19eb3cb.js" defer></script><script src="/assets/js/2.34fff606.js" defer></script><script src="/assets/js/1.16393a26.js" defer></script><script src="/assets/js/71.0051199b.js" defer></script>
  </body>
</html>
