(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{310:function(a,s,t){"use strict";t.r(s);var e=t(14),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"dockerfile自定义镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile自定义镜像"}},[a._v("#")]),a._v(" Dockerfile自定义镜像")]),a._v(" "),s("h2",{attrs:{id:"自定义镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义镜像"}},[a._v("#")]),a._v(" 自定义镜像")]),a._v(" "),s("p",[a._v("镜像就是包含了应用程序、程序运行的系统函数库、运行配置等文件的文件包。构建镜像的过程其实就是把上述文件 按照顺序逐层打包。")]),a._v(" "),s("h2",{attrs:{id:"dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[a._v("#")]),a._v(" Dockerfile")]),a._v(" "),s("p",[a._v("Dockerfile就是一个文本文件，其中包含一个个的指令(Instruction)，用指令来说明要执行什么操作来构建镜像。将来 Docker可以根据Dockerfile帮我们构建镜像。常见指令如下：")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("指令")]),a._v(" "),s("th",[a._v("说明")]),a._v(" "),s("th",[a._v("示例")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("FROM")]),a._v(" "),s("td",[a._v("指定基础镜像")]),a._v(" "),s("td",[a._v("FROM centos:6")])]),a._v(" "),s("tr",[s("td",[a._v("ENV")]),a._v(" "),s("td",[a._v("设置环境变量，可在后面指令使用")]),a._v(" "),s("td",[a._v("ENV key value")])]),a._v(" "),s("tr",[s("td",[a._v("COPY")]),a._v(" "),s("td",[a._v("拷贝本地文件到镜像的指定目录")]),a._v(" "),s("td",[a._v("COPY ./mysql-5.7.rpm /tmp")])]),a._v(" "),s("tr",[s("td",[a._v("RUN")]),a._v(" "),s("td",[a._v("执行 Linux 的 shell 命令")]),a._v(" "),s("td",[a._v("RUN yum install gcc")])]),a._v(" "),s("tr",[s("td",[a._v("EXPOSE")]),a._v(" "),s("td",[a._v("指定容器运行时监听的端口，是给镜像使用者看的")]),a._v(" "),s("td",[a._v("EXPOSE 8080")])]),a._v(" "),s("tr",[s("td",[a._v("ENTRYPOINT")]),a._v(" "),s("td",[a._v("镜像中应用的启动命令")]),a._v(" "),s("td",[a._v("ENTRYPOINT java -jar xx.jar")])])])]),a._v(" "),s("p",[a._v("我们可以基于Ubuntu基础影响，利用Dockerfile描述镜像结构，也可以直接基于JDK为基础镜像，省略前面的步骤")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/demo223/pictures/master/img/image-20230924203902578.png",alt:"image-20230924203902578"}})]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 基础镜像")]),a._v("\nFROM openjdk:11.0-jre-buster\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设定时区")]),a._v("\nENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Asia/Shanghai\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ln")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-snf")]),a._v(" /usr/share/zoneinfo/"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TZ")]),a._v(" /etc/localtime "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TZ")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /etc/timezone\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 拷贝jar包")]),a._v("\nCOPY hm-service.jar /app.jar\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 入口")]),a._v("\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-jar"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/app.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("blockquote",[s("p",[a._v("解释：")]),a._v(" "),s("ol",[s("li",[s("code",[a._v("FROM openjdk:11.0-jre-buster")]),a._v('：指定了该镜像基于 OpenJDK 11 的 JRE 版本，并基于 Debian "Buster" 发行版构建。')]),a._v(" "),s("li",[s("code",[a._v("ENV TZ=Asia/Shanghai")]),a._v("：设置了环境变量 "),s("code",[a._v("TZ")]),a._v(' 为 "Asia/Shanghai"，表示该容器将会运行在中国上海时区。')]),a._v(" "),s("li",[s("code",[a._v("RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone")]),a._v("：运行该命令来设置容器中的时区为 "),s("code",[a._v("$TZ")]),a._v(" 变量所指定的时区，以保证应用程序正确地处理时间相关的操作。")]),a._v(" "),s("li",[s("code",[a._v("COPY hm-service.jar /app.jar")]),a._v("：将当前目录下名为 "),s("code",[a._v("hm-service.jar")]),a._v(" 的文件拷贝到容器中的 "),s("code",[a._v("/app.jar")]),a._v(" 路径下，注意这里将文件重命名为 "),s("code",[a._v("app.jar")]),a._v("。")]),a._v(" "),s("li",[s("code",[a._v('ENTRYPOINT ["java", "-jar", "/app.jar"]')]),a._v("：定义了镜像的入口命令。当容器启动时，它将自动执行该命令。这里表示启动 Java 进程，传递 "),s("code",[a._v("/app.jar")]),a._v(" 作为参数。")])]),a._v(" "),s("p",[a._v("对于这里的Dockerfile文件的构建，将会构建一个基于OpenJDK 11的JRE版本的镜像，其中包含了应用程序的jar包，并且将默认使用"),s("code",[a._v("java -jar")]),a._v("命令启动应用程序。")])]),a._v(" "),s("h2",{attrs:{id:"构建镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像"}},[a._v("#")]),a._v(" 构建镜像")]),a._v(" "),s("p",[a._v("当编写好了Dockerfile，可以利用下面命令来构建镜像")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" myImage:1.0 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("blockquote",[s("p",[a._v("命令 "),s("code",[a._v("docker build -t myImage:1.0 .")]),a._v(" 的含义如下：")]),a._v(" "),s("ol",[s("li",[s("code",[a._v("docker build")]),a._v(": 构建一个 Docker 镜像。")]),a._v(" "),s("li",[s("code",[a._v("-t myImage:1.0")]),a._v(": 使用 "),s("code",[a._v("-t")]),a._v(' 参数来指定镜像的名称和标签。这里的镜像名称为 "'),s("code",[a._v("myImage")]),a._v('"，标签为 "'),s("code",[a._v("1.0")]),a._v('"。')]),a._v(" "),s("li",[s("code",[a._v(".")]),a._v(": 指定当前目录为构建上下文，也就是告诉 Docker 在当前目录中查找 Dockerfile 和其他需要构建到镜像中的文件。")])]),a._v(" "),s("p",[a._v("因此，执行这个命令将会在当前目录下查找名为 "),s("code",[a._v("Dockerfile")]),a._v(" 的文件，并根据其中的指令构建一个名为 "),s("code",[a._v("hmall")]),a._v(" 的 Docker 镜像。")])]),a._v(" "),s("p",[a._v("然后通过"),s("code",[a._v("docker images")]),a._v("即可查看到创建的镜像。")]),a._v(" "),s("h2",{attrs:{id:"练习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[a._v("#")]),a._v(" 练习")]),a._v(" "),s("p",[a._v("准备条件：")]),a._v(" "),s("ol",[s("li",[a._v("打包好并上传到服务器中的"),s("code",[a._v("hm-service.jar")]),a._v("文件")]),a._v(" "),s("li",[a._v("安装上面例子构建的"),s("code",[a._v("Dockerfile")]),a._v("文件")])]),a._v(" "),s("h3",{attrs:{id:"创建并启动容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建并启动容器"}},[a._v("#")]),a._v(" 创建并启动容器")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" hmall "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(":8080 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" my_network hmall\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("blockquote",[s("ul",[s("li",[s("code",[a._v("docker run")]),a._v(": 运行一个 Docker 容器。")]),a._v(" "),s("li",[s("code",[a._v("-d")]),a._v(": 后台运行容器。")]),a._v(" "),s("li",[s("code",[a._v("--name hmall")]),a._v(": 指定容器的名称为 "),s("code",[a._v("hmall")]),a._v("。")]),a._v(" "),s("li",[s("code",[a._v("-p 8080:8080")]),a._v(": 将容器内部的 8080 端口映射到主机的 8080 端口。这样，可以通过浏览器访问本地的 8080 端口来访问容器内部的应用程序。")]),a._v(" "),s("li",[s("code",[a._v("--network my_network")]),a._v(": 指定容器连接到名为 "),s("code",[a._v("my_network")]),a._v(" 的自定义网络中。")]),a._v(" "),s("li",[s("code",[a._v("hmall")]),a._v(": 后面跟着要运行的镜像的名称。")])]),a._v(" "),s("p",[a._v("因此，执行该命令将会在名为 "),s("code",[a._v("my_network")]),a._v(" 的自定义网络中启动一个名为 "),s("code",[a._v("hmall")]),a._v(" 的后台容器，并将容器内部的 "),s("code",[a._v("8080")]),a._v("端口映射到主机的 "),s("code",[a._v("8080")]),a._v("端口。您可以通过浏览器访问 "),s("code",[a._v("http://localhost:8080")]),a._v(" 来访问该容器内部的应用程序。")])]),a._v(" "),s("p",[a._v("此时通过服务"),s("code",[a._v("ip地址:8080/...")]),a._v("即可成功请求。")]),a._v(" "),s("h3",{attrs:{id:"nginx容器配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx容器配置"}},[a._v("#")]),a._v(" nginx容器配置")]),a._v(" "),s("p",[a._v("创建nginx文件夹，并添加"),s("code",[a._v("html")]),a._v("文件夹和"),s("code",[a._v("nginx.conf")]),a._v("配置文件，作为nginx容器挂载的目录")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" hmall_nginx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18080")]),a._v(":18080 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18081")]),a._v(":18081 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/nginx/html:/usr/share/nginx/html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/nginx/nginx.conf:/etc/nginx/nginx.conf "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/nginx/log:/var/log/nginx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" my_network "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  nginx\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("blockquote",[s("p",[a._v("注意这里的"),s("code",[a._v("nginx.conf")]),a._v("里面的"),s("code",[a._v("location")]),a._v("需要和容器位置位置("),s("code",[a._v("/usr/share/nginx/html")]),a._v(")匹配，")])]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("worker_processes")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" 1;")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("events")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    worker_connections")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" 1024;")]),a._v("\n}\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("http")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    include")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("      mime.types;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    default_type")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" application/json;")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    sendfile")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("       on;")]),a._v("\n    \n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    keepalive_timeout")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" 65;")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    server")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        listen")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("      18080;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("        # 指定前端项目所在的位置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/ {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            root")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/usr/share/nginx/html/hmall-portal;")]),a._v("\n        }\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        error_page")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("  500 502 503 504  /50x.html;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/50x.html {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            root")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("  html;")]),a._v("\n        }\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/api {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            rewrite")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/api/(.*)  /$1 break;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_pass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://hmall:8080;")]),a._v("\n        }\n    }\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("    server")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        listen")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("      18081;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("        # 指定前端项目所在的位置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/ {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            root")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/usr/share/nginx/html/hmall-admin;")]),a._v("\n        }\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        error_page")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("  500 502 503 504  /50x.html;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/50x.html {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            root")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("  html;")]),a._v("\n        }\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/api {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            rewrite")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/api/(.*)  /$1 break;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_pass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://hmall:8080;")]),a._v("\n        }\n    }\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br"),s("span",{staticClass:"line-number"},[a._v("47")]),s("br")])]),s("h3",{attrs:{id:"mysql容器创建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql容器创建"}},[a._v("#")]),a._v(" mysql容器创建")]),a._v(" "),s("p",[a._v("在当前目录下创建了相应的 "),s("code",[a._v("hmall/mysql/data")]),a._v("、"),s("code",[a._v("hmall/mysql/conf")]),a._v(" 和 "),s("code",[a._v("hmall/mysql/init")]),a._v(" 目录，并且添加 MySQL 配置文件和初始化脚本。")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" hmall_mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("13306")]),a._v(":13306 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Asia/Shanghai "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_ROOT_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("123456")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/mysql/data:/var/lib/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/mysql/conf:/etc/mysql/conf.d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /demo/hmall/mysql/init:/docker-entrypoint-initdb.d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" my_network "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v(" \n mysql\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("blockquote",[s("ul",[s("li",[s("code",[a._v("-d")]),a._v("：通过该参数指定容器以后台模式运行。")]),a._v(" "),s("li",[s("code",[a._v("--name hmall_mysql")]),a._v('：通过该参数指定容器的名称为 "hmall_mysql"。')]),a._v(" "),s("li",[s("code",[a._v("-p 13306:13306")]),a._v("：通过该参数将主机的 13306 端口映射到容器的 13306 端口，用于网络访问。")]),a._v(" "),s("li",[s("code",[a._v("-e TZ=Asia/Shanghai")]),a._v("：通过该参数设置容器的时区为亚洲/上海。")]),a._v(" "),s("li",[s("code",[a._v("-e MYSQL_ROOT_PASSWORD=123456")]),a._v('：通过该参数设置 MySQL root 用户的密码为 "123456"。请确保将此密码替换为更安全的密码。')]),a._v(" "),s("li",[s("code",[a._v("-v ./hmall/mysql/data:/var/lib/mysql")]),a._v("：通过该参数将主机上的目录 "),s("code",[a._v("./hmall/mysql/data")]),a._v(" 挂载到容器的 "),s("code",[a._v("/var/lib/mysql")]),a._v(" 目录，用于持久化存储 MySQL 数据。")]),a._v(" "),s("li",[s("code",[a._v("-v ./hmall/mysql/conf:/etc/mysql/conf.d")]),a._v("：通过该参数将主机上的目录 "),s("code",[a._v("./hmall/mysql/conf")]),a._v(" 挂载到容器的 "),s("code",[a._v("/etc/mysql/conf.d")]),a._v(" 目录，用于自定义 MySQL 配置。")]),a._v(" "),s("li",[s("code",[a._v("-v ./hmall/mysql/init:/docker-entrypoint-initdb.d")]),a._v("：通过该参数将主机上的目录 "),s("code",[a._v("./hmall/mysql/init")]),a._v(" 挂载到容器的 "),s("code",[a._v("/docker-entrypoint-initdb.d")]),a._v(" 目录，用于初始化数据库。")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);